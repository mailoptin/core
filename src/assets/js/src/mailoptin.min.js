import $ from"jquery";import Cookies from"js.cookie";import Pikaday from"pikaday";import mailoptin_globals from"mailoptin_globals";import moModal from"moModal";import moExitIntent from"moExitIntent";import moScrollTrigger from"moScrollTrigger";import mcGroupsValidation from"mc-groups-validation";import recaptcha from"recaptcha";$.MailOptin={is_adblock_script_loaded:!1,is_customize_preview:"true"===mailoptin_globals.is_customize_preview,track_impression:function(i){if(!0!==$.MailOptin.is_customize_preview&&"true"!==mailoptin_globals.disable_impression_tracking){var t={optin_uuid:i,conversion_page:window.location.href,referrer:document.referrer||""};$.post(mailoptin_globals.mailoptin_ajaxurl.toString().replace("%%endpoint%%","track_optin_impression"),{stat_data:t})}}};var mailoptin_optin={content_locker_storage:[],mailoptin_jq_plugin:function(){var i=this;$.fn.mailoptin=function(t){var e,o,n,a,s,r;if(t=void 0!==t&&t,o=this.attr("id"),n=this.attr("data-optin-type"),a=o+"_"+n,void 0!==(s=i.optin_js_config(a))){if(r=!0===$.MailOptin.is_customize_preview||s.test_mode,!1===this.hasClass("mo-optin-form-lightbox")&&$(document).on("click.moOptin",'a[rel~="moOptin:close"], .mo-close-optin',{optin_uuid:o,optin_type:n,optin_js_config:s,self:i},i.close_optin),!0===$.MailOptin.is_customize_preview&&($(document).off("submit.moOptinSubmit","form.mo-optin-form"),$(document).off("click.moOptinSubmit",".mo-optin-form-submit-button"),$(document).off("click.moOptin",'a[rel~="moOptin:close"]'),$(document).off("click.moOptin",".mo-close-optin")),this.hasClass("mo-optin-form-lightbox")&&(e={optin_uuid:o,bodyClose:s.body_close,keyClose:s.body_close,test_mode:r,iconClose:s.icon_close,onOpen:function(){i.animate_optin_display.call(this,s.effects)},onClose:function(){i.set_cookie("exit",o,s)}},!0===$.MailOptin.is_customize_preview&&(e.keyClose=!1,e.bodyClose=!1,e.test_mode=!0),s=$.extend({},e,s),console.log(s),i.process_optin_form_display.call(this,s,"lightbox",t)),this.hasClass("mo-optin-form-bar")){if(i.is_flag_optin_type_active(s,"bar"))return;i.process_optin_form_display.call(this,s,"bar",t)}if(this.hasClass("mo-optin-form-slidein")){if(i.is_flag_optin_type_active(s,"slidein"))return;i.process_optin_form_display.call(this,s,"slidein",t)}this.hasClass("mo-optin-form-sidebar")&&i.process_optin_form_display.call(this,s,"sidebar",t),this.hasClass("mo-optin-form-inpost")&&i.process_optin_form_display.call(this,s,"inpost",t),$(document).on("click",".mo-trigger-conversion",(function(){i.set_cookie("success",o,s),i.ga_event_tracking("conversion",s)})),i.is_var_defined(s,"cta_display")&&!0===s.cta_display&&i.is_var_defined(s,"cta_action")&&$(document).on("click","#"+a+"_cta_button",(function(t){t.preventDefault();var e=$(this).parents(".moOptinForm");if("navigate_to_url"===s.cta_action&&i.is_var_defined(s,"cta_navigate_url")){if(!0===$.MailOptin.is_customize_preview)return;i.set_cookie("success",o,s),i.ga_event_tracking("conversion",s),window.location.assign(s.cta_navigate_url)}else if("reveal_optin_form"===s.cta_action){var n=$("#"+a);n.find(".mo-optin-form-cta-button, .mo-optin-form-cta-wrapper").hide(),n.find(".mo-optin-fields-wrapper").show(),n.find(".mo-optin-form-submit-button").show(),$("#"+o).removeClass("mo-cta-button-flag")}else-1!==$.inArray(s.cta_action,["close_optin","close_optin_reload_page"])?($.MoModalBox.close(),mailoptin_optin._close_optin(e),"close_optin_reload_page"===s.cta_action&&window.location.reload()):console.warn("something went wrong.");return!1})),$.MailOptin.is_customize_preview||!0!==i.is_adblock_rule_active(s)||!1!==$.MailOptin.is_adblock_script_loaded||(i.load_adblock_detect_script(),$.MailOptin.is_adblock_script_loaded=!0)}},$.fn.extend({animateOptin:function(i){this.addClass("MOanimated "+i).one("webkitAnimationEnd mozAnimationEnd MSAnimationEnd oanimationend animationend",(function(){$(this).removeClass("MOanimated "+i)}))}})},is_after_x_seconds_active:function(i){return void 0!==i.x_seconds_status&&!0===i.x_seconds_status&&void 0!==i.x_seconds_value},is_after_x_scroll_active:function(i){return!0===i.x_scroll_status&&void 0!==i.x_scroll_value},is_after_x_page_views_active:function(i){return!0===i.x_page_views_status&&void 0!==i.x_page_views_condition&&void 0!==i.x_page_views_value},is_exit_intent_active:function(i){return!0===i.exit_intent_status},load_adblock_detect_script:function(){var i=document.createElement("script");i.src=mailoptin_globals.public_js+"/ad-m.js",i.async=!0,(document.getElementsByTagName("head")[0]||document.documentElement).appendChild(i)},is_newvsreturn_rule_active:function(i){return!0===i.newvsreturn_status},is_referrer_detection_rule_active:function(i){return!0===i.referrer_detection_status},is_adblock_rule_active:function(i){return!0===i.adblock_status},is_optin_visible:function(i){if("optin_form_shown"!==i.state_after_conversion){var t=i.optin_uuid;if(i.global_success_cookie>0&&Cookies.get("mo_global_success_cookie"))return!1;if(i.global_cookie>0&&Cookies.get("mo_global_cookie"))return!1;if(Cookies.get("mo_success_"+t))return!1;if(Cookies.get("mo_"+t))return!1}return!0},split_test_cookie_test:function(i){if(!0===i.is_split_test){var t=!0,e=mailoptin_optin;if(i.optin_campaign_id in i.split_test_variants)return $.each(i.split_test_variants,(function(i,o){if(e.is_var_defined(o,"state_after_conversion")&&"optin_form_shown"!==o.state_after_conversion&&!1===e.is_optin_visible(o))return t=!1,!1})),t}return!0},process_optin_form_display:function(i,t,e){var o=mailoptin_optin,n=this;!0===o.is_adblock_rule_active(i)?$(window).on("load",(function(){o.rule_base_show_optin_form.call(n,i,t,e)})):o.rule_base_show_optin_form.call(n,i,t,e)},rule_base_show_optin_form:function(i,t,e){console.log(optin_js_config);var o=mailoptin_optin,n=this;if(!0===$.MailOptin.is_customize_preview||!0===i.test_mode||!0===e)return o.display_optin_form.call(n,i,t,e);if((!o.is_var_defined(i,"click_launch_status")||!0!==i.click_launch_status||!1!==e)&&!1!==o.is_optin_visible(i)&&!1!==o.split_test_cookie_test(i)){if(o.is_after_x_page_views_active(i)){var a=i.x_page_views_condition,s=i.x_page_views_value;switch(a){case"equals":if(o.get_page_views()!==s)return;break;case"more_than":if(o.get_page_views()<=s)return;break;case"less_than":if(o.get_page_views()>=s)return;break;case"at_least":if(o.get_page_views()<s)return;break;case"not_more_than":if(o.get_page_views()>s)return}}if(!0===o.is_referrer_detection_rule_active(i)){var r=function(i){return i.replace(/\/+$/,"")},_=document.referrer.toLowerCase()||!1;if(!_)return;var c=i.referrer_detection_settings,l=i.referrer_detection_values;if("show_to"===c){var p=!1;$.each(l,(function(i,t){if(t=r(t).toLowerCase(),-1!==_.indexOf(t))return p=!0,!1}))}if("hide_from"===c){p=!0;$.each(l,(function(i,t){if(t=r(t),-1!==_.indexOf(t))return p=!1,!1}))}if(!p)return}if(!0===o.is_newvsreturn_rule_active(i)){if("is_new"===i.newvsreturn_settings&&o.visitor_is_returning())return;if("is_returning"===i.newvsreturn_settings&&o.visitor_is_new())return}if(!0===o.is_adblock_rule_active(i)){if("adblock_enabled"===i.adblock_settings&&o.isAdblockDisabled())return;if("adblock_disabled"===i.adblock_settings&&o.isAdblockEnabled())return}if(void 0!==window.MobileDetect){var u=new MobileDetect(window.navigator.userAgent);if(!0===i.device_targeting_hide_mobile&&u.phone())return;if(!0===i.device_targeting_hide_tablet&&u.tablet())return;if(!0===i.device_targeting_hide_desktop&&!u.mobile())return}if(o.is_var_defined(i,"wc_atc_activate_rule")&&!0===i.wc_atc_activate_rule){if($(document.body).on("added_to_cart",(function(e,a,s,r){var _=r.data("product_id");return(!o.is_var_defined(i,"wc_atc_products")||-1!==$.inArray(_,i.wc_atc_products))&&o.display_optin_form.call(n,i,t)})),o.is_var_defined(mailoptin_globals,"wc_atc_products")){if(o.is_var_defined(i,"wc_atc_products"))if(0===i.wc_atc_products.filter((function(i){return-1!==mailoptin_globals.wc_atc_products.indexOf(i)})).length)return!1;return o.display_optin_form.call(n,i,t)}}else{var d=1e3*i.x_seconds_value,m=i.x_scroll_value;if(!0!==o.is_after_x_seconds_active(i)||!0!==o.is_after_x_scroll_active(i)||!0!==o.is_exit_intent_active(i)){if(!0===o.is_after_x_scroll_active(i)&&!0===o.is_exit_intent_active(i))return $.moScrollTrigger("enable"),void $(document).on("moScrollTrigger",(function(e,a){a>=m&&($.moExitIntent("enable"),$(document).on("moExitIntent",(function(){return o.display_optin_form.call(n,i,t)})))}));if(!0!==o.is_after_x_seconds_active(i)||!0!==o.is_after_x_scroll_active(i))if(!0!==o.is_after_x_seconds_active(i)||!0!==o.is_exit_intent_active(i)){if(!0!==o.is_after_x_seconds_active(i))return o.is_after_x_scroll_active(i)?($.moScrollTrigger("enable"),void $(document).on("moScrollTrigger",(function(e,a){if(!1===n.hasClass("si-open")&&a>=m)return n.addClass("si-open"),o.display_optin_form.call(n,i,t)}))):o.is_exit_intent_active(i)?($.moExitIntent("enable"),void $(document).on("moExitIntent",(function(){return o.display_optin_form.call(n,i,t)}))):o.display_optin_form.call(n,i,t);setTimeout((function(){return o.display_optin_form.call(n,i,t)}),d)}else setTimeout((function(){$.moExitIntent("enable"),$(document).on("moExitIntent",(function(){return o.display_optin_form.call(n,i,t)}))}),d);else setTimeout((function(){$.moScrollTrigger("enable"),$(document).on("moScrollTrigger",(function(e,a){if(!1===n.hasClass("si-open")&&a>=m)return n.addClass("si-open"),o.display_optin_form.call(n,i,t)}))}),d)}else setTimeout((function(){$.moScrollTrigger("enable"),$(document).on("moScrollTrigger",(function(e,a){a>=m&&($.moExitIntent("enable"),$(document).on("moExitIntent",(function(){return o.display_optin_form.call(n,i,t)})))}))}),d)}}},display_optin_form:function(i,t,e){if(void 0!==t&&void 0!==t){var o=mailoptin_optin;if(!1===$.MailOptin.is_customize_preview&&!1===i.test_mode&&!0!==e){if(!1===o.is_optin_visible(i))return;if(!1===o.split_test_cookie_test(i))return}if(void 0!==t&&"lightbox"===t)return $(document.body).on($.MoModalBox.OPEN,(function(i,t,e){$(this).trigger("moOptin:show",[e.optin_uuid,e])})),void this.MoModalBox(i);if(o.animate_optin_display.call(this,i.effects),o.flag_optin_type_displayed(i,t),"bar"===t&&"top"===i.bar_position){var n=parseFloat($(document.body).css("margin-top")),a=i.optin_uuid;$(window).on("resize.MoBarTop",(function(){setTimeout((function(){var i=$("#"+a+"_bar"),t=$("#wpadminbar"),e=i.outerHeight();$(window).width()<=600&&t.length>0&&($("#"+a+".mo-optin-form-bar-sticky").length>0?e-=t.outerHeight():e+=t.outerHeight()),e=$.MailOptin.activeBarHeight=n+e,$(document.body).css("margin-top",n+e+"px")}),500)})),$(window).resize()}this.show(),$(this).trigger("moOptin:show",[i.optin_uuid,i,t])}},flag_optin_type_displayed:function(i,t){if("bar"===t){var e=i.bar_position;$.MailOptin["isActiveMOBar_"+e]=!0}if("slidein"===t){var o=i.slidein_position;$.MailOptin["isActiveMOSlidein_"+o]=!0}},flag_optin_type_close:function(i,t){if("bar"===t){var e=i.bar_position;$.MailOptin["isActiveMOBar_"+e]=!1}if("slidein"===t){var o=i.slidein_position;$.MailOptin["isActiveMOSlidein_"+o]=!1}},is_flag_optin_type_active:function(i,t){if("bar"===t){var e=i.bar_position;return!0===$.MailOptin["isActiveMOBar_"+e]}if("slidein"===t){var o=i.slidein_position;return!0===$.MailOptin["isActiveMOSlidein_"+o]}},close_optin:function(i){i.preventDefault();var t=$(this).parents(".moOptinForm"),e=t.attr("id"),o=t.attr("data-optin-type"),n=mailoptin_optin.optin_js_config(e);mailoptin_optin._close_optin(t),t.removeClass("si-open"),mailoptin_optin.set_cookie("exit",e,n),mailoptin_optin.flag_optin_type_close(n,o)},_close_optin:function(i){i.fadeOut(400,(function(){$(this).trigger("moOptin:close",[this]);var t=i.attr("id"),e=mailoptin_optin.optin_js_config(t);if("bar"===e.optin_type&&"top"===e.bar_position){var o=parseFloat($(document.body).css("margin-top"));$(document.body).css("margin-top",o-$.MailOptin.activeBarHeight+"px"),delete $.MailOptin.activeBarHeight,$(window).off("resize.MoBarTop")}}))},track_page_views:function(){if("true"===mailoptin_globals.is_new_returning_visitors_cookies){var i=Cookies.get("mo_page_views_counter"),t=void 0===i?0:i;Cookies.set("mo_page_views_counter",++t)}},set_visitor_cookies:function(){"true"===mailoptin_globals.is_new_returning_visitors_cookies&&(Cookies.get("mo_has_visited")||(Cookies.set("mo_is_new","true"),Cookies.set("mo_has_visited","true",{expires:3999})))},isAdblockEnabled:function(){return"undefined"==typeof mailoptin_no_adblock_detected},isAdblockDisabled:function(){return"undefined"!=typeof mailoptin_no_adblock_detected},visitor_is_new:function(){return"true"===Cookies.get("mo_has_visited")&&"true"===Cookies.get("mo_is_new")},visitor_is_returning:function(){return"true"===Cookies.get("mo_has_visited")&&!Cookies.get("mo_is_new")},get_page_views:function(){return Number(Cookies.get("mo_page_views_counter"))},animate_optin_display:function(i){""===i&&void 0===i||this.find(".mo-optin-form-wrapper").animateOptin(i)},optin_js_config:function(i){return window[i]},optin_conversion:function(){var i,t,e,o,n,a,s;if(s=this,!0!==$.MailOptin.is_customize_preview){var r=function(r){if(r.preventDefault(),r.stopPropagation(),t=$(this).parents(".moOptinForm"),e=t.attr("id"),o=t.attr("data-optin-type"),n=e+"_"+o,a=s.optin_js_config(n),s.hide_optin_error(e,t),s.validate_optin_form_fields(n,a,t)){var _=$("form#"+n+"_form").serializeArray().reduce((function(i,t){if(-1!==t.name.indexOf("[]")){var e=t.name.replace("[]","");void 0===i[e]?(i[e]=[],i[e].push(t.value)):i[e].push(t.value)}else i[t.name]=t.value;return i}),{});i=$.extend({},_,{optin_uuid:e,optin_campaign_id:a.optin_campaign_id,email:$("input#"+n+"_email_field",t).val(),name:$("input#"+n+"_name_field",t).val(),_mo_timestamp:$("input#"+n+"_honeypot_timestamp").val(),user_agent:navigator.userAgent,conversion_page:window.location.href,referrer:document.referrer||""}),s.addProcessingOverlay.call(t),s.subscribe_to_email_list(i,t,a,o)}};$(document).on("submit.moOptinSubmit","form.mo-optin-form",r),$(document).on("click.moOptinSubmit",".mo-optin-form-submit-button",r)}},addProcessingOverlay:function(){this.find(".mo-optin-spinner").show()},removeProcessingOverlay:function(){this.find(".mo-optin-spinner").hide()},addSuccessCloseIcon:function(){this.find(".mo-optin-spinner").after('<a href="#" class="mo-optin-success-close" rel="moOptin:close">×</a>')},removeSuccessCloseIcon:function(){this.find(".mo-optin-success-close").remove()},displaySuccessContent:function(){this.find(".mo-optin-success-msg").show()},removeSpinner:function(){this.find(".mo-optin-spinner").css("background-image","none")},displayErrorMessage:function(i){this.find(".mo-optin-error").html(i).show()},set_cookie:function(i,t,e){var o=e.test_mode||!1,n=e.cookie;if("success"==i)n=e.success_cookie;i="exit"===i?"":i+"_",o||(Cookies.set("mo_"+i+t,!0,{expires:n}),Cookies.set("mo_global_"+i+"cookie",!0,{expires:e["global_"+i+"cookie"]}))},subscribe_to_email_list:function(i,t,e,o){var n=this;$.post(mailoptin_globals.mailoptin_ajaxurl.toString().replace("%%endpoint%%","subscribe_to_email_list"),{optin_data:i},(function(a){!$.isEmptyObject(a)&&"success"in a?!0===a.success?($(document.body).trigger("moOptinConversion",[t,e,i]),n.set_cookie("success",i.optin_uuid,e),-1!==$.inArray(o,["lightbox","bar","slidein"])&&!0!==e.icon_close&&n.addSuccessCloseIcon.call(t),n.displaySuccessContent.call(t),n.removeSpinner.call(t)):(n.removeProcessingOverlay.call(t),n.removeSuccessCloseIcon.call(t),n.displayErrorMessage.call(t,a.message)):(n.displayErrorMessage.call(t,e.unexpected_error),n.removeProcessingOverlay.call(t),n.removeSuccessCloseIcon.call(t))}),"json")},validate_optin_form_fields:function(i,t,e){var o=t.name_missing_error,n=t.email_missing_error,a=t.honeypot_error,s=t.note_acceptance_error,r=t.custom_field_required_error,_=this,c=$("#"+i+"_name_field:visible",e),l=$("#"+i+"_email_field:visible",e),p=$("#"+i+" .mo-acceptance-checkbox",e),u=$("#"+i+"_honeypot_email_field",e).val(),d=$("#"+i+"_honeypot_website_field",e).val(),m=!0;return(u.length>0||d.length>0)&&(_.display_optin_error.call(void 0,i,a,e),m=!1),$("#"+i+" .mo-optin-form-custom-field",e).each((function(){var o=$(this),n=$(this).data("field-id"),a=t.required_custom_fields,s=o.val();o.find("input[type=radio]").length>0&&(s=0===o.find("input[type=radio]:checked").length?"":o.find("input[type=radio]:checked").val()),o.find("input[type=checkbox]").length>0&&(s=0===o.find("input[type=checkbox]:checked").length?"":o.find("input[type=checkbox]:checked").val()),-1!==$.inArray(n,a)&&""===s&&(_.display_optin_error.call(o,i,r,e),m=!1)})),l.length>0&&!1===_.isValidEmail(l.val())&&(_.display_optin_error.call(l,i,n,e),m=!1),!0===t.name_field_required&&c.length>0&&""===c.val()&&(_.display_optin_error.call(c,i,o,e),m=!1),!1===m?m:p.length>0&&!1===p[0].checked?(_.display_optin_error.call(void 0,i,s,e),!1):(!1===$(document.body).triggerHandler("mo_validate_optin_form_fields",[_,i,t])&&(m=!1),m)},display_optin_error:function(i,t,e){void 0!==this&&(this.css("-webkit-box-shadow","inset 0px 0px 0px 2px #f45a4a"),this.css("-moz-box-shadow","inset 0px 0px 0px 2px #f45a4a"),this.css("box-shadow","inset 0px 0px 0px 2px #f45a4a"));var o=$("div#"+i+" .mo-optin-error",e);void 0!==t&&void 0!==o&&o.length>0&&"string"==typeof t&&o.text(t).show()},hide_optin_error:function(i,t){var e=$(".mo-optin-field",t);$(".mo-optin-error",t).hide(),e.css("-webkit-box-shadow",""),e.css("-moz-box-shadow",""),e.css("box-shadow","")},isValidEmail:function(i){return new RegExp(/^((([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+(\.([a-z]|\d|[!#\$%&'\*\+\-\/=\?\^_`{\|}~]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])+)*)|((\x22)((((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(([\x01-\x08\x0b\x0c\x0e-\x1f\x7f]|\x21|[\x23-\x5b]|[\x5d-\x7e]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(\\([\x01-\x09\x0b\x0c\x0d-\x7f]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF]))))*(((\x20|\x09)*(\x0d\x0a))?(\x20|\x09)+)?(\x22)))@((([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|\d|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.)+(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])|(([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])([a-z]|\d|-|\.|_|~|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])*([a-z]|[\u00A0-\uD7FF\uF900-\uFDCF\uFDF0-\uFFEF])))\.?$/i).test(i)},ga_event_tracking:function(i,t){i=i||"impression",!1!==mailoptin_optin.is_var_defined(t,"ga_active")&&"function"==typeof ga&&ga((function(){var e=ga.getAll()[0].get("trackingId");!1!==mailoptin_optin.is_defined_not_empty(e)&&(ga("create",e,"auto","moTracker"),ga("moTracker.send","event",t.optin_campaign_name,i,t.optin_uuid,{nonInteraction:!0}))}))},success_action_after_conversion:function(i,t,e,o){var n=e.success_action,a=e.redirect_url_value,s=e.success_js_script,r=void 0!==s&&""!==s,_={};_.mo_name=_.mo_email="",mailoptin_optin.is_defined_not_empty(o.name)&&(_.mo_name=o.name),mailoptin_optin.is_defined_not_empty(o.email)&&(_.mo_email=o.email),mailoptin_optin.ga_event_tracking("conversion",e),mailoptin_optin.content_locker_removal(e),!0===r&&(-1===s.indexOf("<script")&&(s='<script type="text/javascript">'+s+"<\/script>"),s=s.replace(/\[EMAIL\]/gi,_.mo_email).replace(/\[NAME\]/gi,_.mo_name),$(t).append(s)),void 0!==n&&-1!==$.inArray(n,["close_optin","redirect_url","close_optin_reload_page"])&&setTimeout((function(){if($.MoModalBox.close(),mailoptin_optin._close_optin(t),"close_optin_reload_page"===n)return window.location.reload();"redirect_url"===n&&void 0!==a&&""!==a&&(void 0!==e.pass_lead_data&&!0===e.pass_lead_data&&(a=mailoptin_optin.add_query_args(a,_)),window.location.assign(a))}),1e3)},eventSubscription:function(){$(document.body).on("moOptin:show",(function(i,t,e){mailoptin_optin.content_locker_init(e),$.MailOptin.track_impression(t),mailoptin_optin.ga_event_tracking("impression",e)})),$(document.body).on("moOptinConversion",this.success_action_after_conversion)},is_content_locker_enabled:function(i){return mailoptin_optin.is_var_defined(i,"content_lock_status")&&!0===i.content_lock_status&&mailoptin_optin.is_var_defined(i,"content_lock_style")},content_locker_init:function(i){if(mailoptin_optin.is_content_locker_enabled(i)){var t=$("#"+i.optin_uuid).nextAll();"removal"===i.content_lock_style?t.each((function(i,t){mailoptin_optin.content_locker_storage.push($(t).clone(!0)),$(t).remove()})):t.each((function(i,t){$(t).addClass("mailoptin-content-lock")}))}},content_locker_removal:function(i){if(mailoptin_optin.is_content_locker_enabled(i)){var t=$("#"+i.optin_uuid),e=t.nextAll();"removal"===i.content_lock_style?(mailoptin_optin.content_locker_storage.reverse(),$.each(mailoptin_optin.content_locker_storage,(function(i,e){t.after(e)}))):e.each((function(i,t){$(t).removeClass("mailoptin-content-lock")}))}},add_query_args:function(i,t){var e=-1!==i.indexOf("?")?"&":"?";for(var o in t)t.hasOwnProperty(o)&&(i+=e+o+"="+t[o],e="&");return i},initOptinForms:function(){$(".moOptinForm").each((function(i,t){$(t).mailoptin()}));var i=function(i){void 0!==i&&$(["#"+i+".mo-optin-form-lightbox","#"+i+".mo-optin-form-bar","#"+i+".mo-optin-form-slidein"].join(",")).mailoptin(!0)};$(document).on("click",".mailoptin-click-trigger",(function(t){t.preventDefault();var e=$(this).data("optin-uuid")||$(this).attr("id");i(e)})),$(document).on("click",'[class*="mailoptin-click-trigger-"]',(function(t){t.preventDefault();var e,o=this.className.match(/mailoptin-click-trigger-([a-z0-1]+)\s?/i);null!==o&&(e=o[1],i(e))}))},is_scheduled_for_display:function(){!0!==$.MailOptin.is_customize_preview&&$(".moOptinForm").each((function(){var i=$(this).attr("id"),t=mailoptin_optin.optin_js_config(i),e=t.schedule_status,o=t.schedule_start,n=t.schedule_end,a=t.schedule_timezone;if(mailoptin_optin.is_defined_not_empty(e)&&mailoptin_optin.is_defined_not_empty(o)&&mailoptin_optin.is_defined_not_empty(n)&&mailoptin_optin.is_defined_not_empty(a)){var s,r,_,c,l=new Date;s="visitors_local_time"===a?60*l.getTimezoneOffset()*1e3:1e3*a,r=l.getTime(),_=Date.parse(o+" GMT")-s,c=Date.parse(n+" GMT")-s,!1===(r>=_&&r<=c)?$(this).remove():$(this).mailoptin()}}))},is_var_defined:function(i,t){return void 0!==i[t]},is_defined_not_empty:function(i){return void 0!==i&&""!==i},init_date_picker:function(){$(".mo-optin-form-custom-field.date-field").each((function(){var i=(new Date).getFullYear(),t=150;new Pikaday({field:this,minDate:new Date(i-t,0),maxDate:new Date(i+t,0),yearRange:300,toString:function(i,t){var e=("0"+i.getDate()).slice(-2),o=("0"+(i.getMonth()+1)).slice(-2);return i.getFullYear()+"-"+o+"-"+e}})}))},init:function(){var i=this;i.track_page_views(),i.set_visitor_cookies(),$((function(){i.eventSubscription(),i.mailoptin_jq_plugin(),i.is_scheduled_for_display(),i.initOptinForms(),i.optin_conversion(),i.init_date_picker(),$(document.body).trigger("mo-mailoptinjs-loaded")}))}};moModal(),moExitIntent(),moScrollTrigger(),mcGroupsValidation(),recaptcha(),mailoptin_optin.init();